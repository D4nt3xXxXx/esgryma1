(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"7B4b":function(n,i,t){var e=t("zwU7");"string"==typeof e&&(e=[[n.i,e,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};t("aET+")(e,o);e.locals&&(n.exports=e.locals)},JfU9:function(n,i,t){"use strict";var e=t("7B4b");t.n(e).a},YhOx:function(n,i,t){"use strict";t.r(i);var e=t("vDqi"),o=t.n(e),s={data:function(){return{loading:!1,isPushEnabled:!1,pushButtonDisabled:!0}},mounted:function(){this.registerServiceWorker()},methods:{registerServiceWorker:function(){var n=this;"serviceWorker"in navigator?navigator.serviceWorker.register("/sw.js").then((function(){return n.initialiseServiceWorker()})):console.log("Service workers aren't supported in this browser.")},initialiseServiceWorker:function(){var n=this;"showNotification"in ServiceWorkerRegistration.prototype?"denied"!==Notification.permission?"PushManager"in window?navigator.serviceWorker.ready.then((function(i){i.pushManager.getSubscription().then((function(i){n.pushButtonDisabled=!1,i&&(n.updateSubscription(i),n.isPushEnabled=!0)})).catch((function(n){console.log("Error during getSubscription()",n)}))})):console.log("Push messaging isn't supported."):console.log("The user has blocked notifications."):console.log("Notifications aren't supported.")},subscribe:function(){var n=this;navigator.serviceWorker.ready.then((function(i){var t={userVisibleOnly:!0},e=window.Laravel.vapidPublicKey;e&&(t.applicationServerKey=n.urlBase64ToUint8Array(e)),i.pushManager.subscribe(t).then((function(i){n.isPushEnabled=!0,n.pushButtonDisabled=!1,n.updateSubscription(i)})).catch((function(i){"denied"===Notification.permission?(console.log("Permission for Notifications was denied"),n.pushButtonDisabled=!0):(console.log("Unable to subscribe to push.",i),n.pushButtonDisabled=!1)}))}))},unsubscribe:function(){var n=this;navigator.serviceWorker.ready.then((function(i){i.pushManager.getSubscription().then((function(i){if(!i)return n.isPushEnabled=!1,void(n.pushButtonDisabled=!1);i.unsubscribe().then((function(){n.deleteSubscription(i),n.isPushEnabled=!1,n.pushButtonDisabled=!1})).catch((function(i){console.log("Unsubscription error: ",i),n.pushButtonDisabled=!1}))})).catch((function(n){console.log("Error thrown while unsubscribing.",n)}))}))},togglePush:function(){this.isPushEnabled?this.unsubscribe():this.subscribe()},updateSubscription:function(n){var i=this,t=n.getKey("p256dh"),e=n.getKey("auth"),s=(PushManager.supportedContentEncodings||["aesgcm"])[0],r={endpoint:n.endpoint,publicKey:t?btoa(String.fromCharCode.apply(null,new Uint8Array(t))):null,authToken:e?btoa(String.fromCharCode.apply(null,new Uint8Array(e))):null,contentEncoding:s};this.loading=!0,o.a.post("/subscriptions",r).then((function(){i.loading=!1}))},deleteSubscription:function(n){var i=this;this.loading=!0,o.a.post("/subscriptions/delete",{endpoint:n.endpoint}).then((function(){i.loading=!1}))},sendNotification:function(){var n=this;this.loading=!0,o.a.post("/notifications").catch((function(n){return console.log(n)})).then((function(){n.loading=!1}))},urlBase64ToUint8Array:function(n){for(var i=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(i),e=new Uint8Array(t.length),o=0;o<t.length;++o)e[o]=t.charCodeAt(o);return e}}},r=(t("JfU9"),t("KHd+")),a=Object(r.a)(s,(function(){var n=this,i=n.$createElement,t=n._self._c||i;return t("div",[t("vs-button",{attrs:{disabled:n.loading,type:"filled"},on:{click:n.sendNotification}},[n._v("Enviarme una notificación")]),n._v(" "),t("vs-button",{class:{"vs-button-info":!n.isPushEnabled,"vs-button-danger":n.isPushEnabled},attrs:{disabled:n.pushButtonDisabled||n.loading,type:"filled"},on:{click:n.togglePush}},[n._v(n._s(n.isPushEnabled?"Denegar":"Permitir")+" notificación")])],1)}),[],!1,null,"05d54fe4",null);i.default=a.exports},zwU7:function(n,i,t){(n.exports=t("I1BE")(!1)).push([n.i,"[dir] .btn[data-v-05d54fe4] {\n  margin-bottom: 10px;\n}[dir=ltr] .btn[data-v-05d54fe4] {\n  margin-right: 10px;\n}[dir=rtl] .btn[data-v-05d54fe4] {\n  margin-left: 10px;\n}\n",""])}}]);