(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{tK1U:function(e,t,a){"use strict";a.r(t);var i=a("QBvj"),o=a("ExVU"),s={name:"eliminarNovedad",data:function(){return{idNovedad:null}},methods:{eliminarNovedadId:function(e){this.idNovedad=e,this.$vs.dialog({type:"confirm",color:"danger",title:"Eliminar novedad",text:"Desea eliminar la novedad seleccionada ?",accept:this.eliminar})},eliminar:function(e){var t=this;this.cargandoGeneral=!0,axios.post("/procesos/novedad.eliminar",{id:this.idNovedad}).then((function(e){t.cargandoGeneral=!1,t.mostrarNotificacion("Registro eliminado","La novedad se ha eliminado con exito!","success"),location.reload()}))},editarNovedad:function(e){this.$parent.$parent.infoEditNovedad(e)}}},n=a("KHd+"),r=Object(n.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex items-center"},[a("span",{staticClass:"text-inherit text-info hover:text-primary cursor-pointer",on:{click:function(t){return e.editarNovedad(e.params.data)}}},[a("span",{staticClass:"material-icons"},[e._v("edit")])]),e._v(" "),a("span",{staticClass:"text-inherit text-danger hover:text-primary cursor-pointer",on:{click:function(t){return e.eliminarNovedadId(e.params.data.idNovedad)}}},[a("span",{staticClass:"material-icons"},[e._v("delete")])])])}),[],!1,null,"5a79db1e",null).exports,d=a("Snq/"),l=a.n(d),c=a("wd/R"),v=a.n(c),u={name:"editarNovedad",components:{vSelect:l.a},props:{novedad:{type:[Array,Object],required:!0}},data:function(){return{listaGestores:[]}},created:function(){this.obtenerGestores()},methods:{editarNovedad:function(){var e=this;this.loading=!0,this.calcularHoras(),axios.post("/procesos/novedad.editar",this.novedad).then((function(t){e.loading=!1,e.mostrarNotificacion("Modificación exitosa","Se ha actualizado la novedad con exito!","success"),e.novedad={},e.$parent.$parent.infoActualizada()}))},obtenerGestores:function(){var e=this;axios.post("/reservas/listaGestores").then((function(t){e.listaGestores=t.data}))},calcularHoras:function(){if(null!=this.novedad.fechaInicio&&""!=this.novedad.fechaInicio&&null!=this.novedad.fechaFin&&""!=this.novedad.fechaFin){var e=v()(this.novedad.fechaInicio).locale("America/Bogota"),t=v()(this.novedad.fechaFin).locale("America/Bogota").diff(e,"hours");this.novedad.horas=t}}},watch:{novedad:function(e){null!=this.novedad.fechaInicio&&""!=this.novedad.fechaInicio&&null!=this.novedad.fechaFin&&""!=this.novedad.fechaFin&&(this.novedad.fechaInicio=o.DateTime.fromSQL(this.novedad.fechaInicio).toISO(),this.novedad.fechaFin=o.DateTime.fromSQL(this.novedad.fechaFin).toISO())}}},f={name:"listaNovedades",components:{EditarNovedad:Object(n.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return Object.keys(e.novedad).length>0?a("div",[a("ValidationObserver",{ref:"formNovedad",attrs:{tag:"form"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.handleSubmit;return[a("form",{on:{submit:function(t){return t.preventDefault(),i(e.editarNovedad)}}},[a("vs-card",[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col sm:w-12/12 md:w-12/12 lg:w-12/12 w-full mb-2"},[a("div",{staticClass:"vx-row flex align-bottom justify-space-between "},[a("div",{staticClass:"vx-col sm:w-11/12 md:w-11/12 lg:w-11/12"},[a("span",[e._v("Gestor")]),e._v(" "),a("validation-provider",{attrs:{name:"GESTOR",rules:"required|numeric"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("Select2",{attrs:{options:e.listaGestores},on:{select:function(t){return e.obtenerGestor(t)}},model:{value:e.novedad.idGestor,callback:function(t){e.$set(e.novedad,"idGestor",t)},expression:"novedad.idGestor"}}),e._v(" "),a("span",{staticClass:"text-danger"},[e._v(e._s(i[0]))])]}}],null,!0)})],1),e._v(" "),a("vs-col",{attrs:{"vs-sm":"1","vs-md":"1","vs-lg":"1","vs-align":"flex-end","vs-type":"flex","vs-justify":"space-between"}},[a("vs-button",{attrs:{color:"dark",type:"line",icon:"event_note"}})],1)],1)]),e._v(" "),a("div",{staticClass:"vx-col sm:w-12/12 md:w-6/12 lg:w-6/12 w-full mb-2"},[a("strong",[e._v("Fecha Inicio")]),e._v(" "),a("validation-provider",{attrs:{name:"FECHA INICIO",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("datetime",{attrs:{type:"datetime","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd HH:mm",auto:""},model:{value:e.novedad.fechaInicio,callback:function(t){e.$set(e.novedad,"fechaInicio",t)},expression:"novedad.fechaInicio"}}),e._v(" "),a("span",{staticClass:"text-danger"},[e._v(e._s(i[0]))])]}}],null,!0)})],1),e._v(" "),a("div",{staticClass:"vs-col sm:w-12/12 md:w-6/12 lg:w-6/12 w-full mb-2"},[a("strong",[e._v("Fecha Fin")]),e._v(" "),a("validation-provider",{attrs:{name:"FECHA FIN",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("datetime",{attrs:{type:"datetime","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd HH:mm","min-datetime":e.novedad.fechaInicio,auto:""},model:{value:e.novedad.fechaFin,callback:function(t){e.$set(e.novedad,"fechaFin",t)},expression:"novedad.fechaFin"}}),e._v(" "),a("span",{staticClass:"text-danger"},[e._v(e._s(i[0]))])]}}],null,!0)})],1),e._v(" "),a("div",{staticClass:"vs-col sm:w-12/12 md:w-12/12 lg:w-12/12 w-full"},[a("strong",[e._v("Observación")]),e._v(" "),a("vs-textarea",{staticClass:"w-full",model:{value:e.novedad.observacion,callback:function(t){e.$set(e.novedad,"observacion",t)},expression:"novedad.observacion"}})],1)]),e._v(" "),a("div",{staticClass:"vx-row flex justify-content-center justify-center"},[a("div",{staticClass:"vx-col sm:w-12/12 md:w-12/12 lg:w-12/12  mb-2 center text-center"},[a("boton",{attrs:{texto_cargando:"Guardando novedad...",type:"submit",texto:"Guardar novedad",cargando:e.loading}})],1)])])],1)]}}],null,!1,3402434164)})],1):e._e()}),[],!1,null,"bc6ea2b0",null).exports,AgGridVue:i.AgGridVue,eliminarNovedad:r},data:function(){return{datos:[],searchQuery:"",filtro:{gestor:"",fechaInicio:null,fechaFinal:null},listaGestores:[],infoNovedad:[],abrirPoput:!1,gridApi:null,gridOptions:{},defaultColDef:{sortable:!0,resizable:!0,suppressMenu:!0},columnDefs:[{headerName:"Tipo novedad",field:"tipoNovedad"},{headerName:"Gestor",field:"Gestor"},{headerName:"Fecha Inicio",field:"fechaInicio"},{headerName:"Fecha Fin",field:"fechaFin"},{headerName:"Horas",field:"horas"},{headerName:"Autoriza",field:"autoriza"},{headerName:"Observación",field:"observacion",cellClass:"text-center"},{headerName:"Eliminar",field:"eliminar",width:90,pinned:"right",cellClass:"text-center",cellRendererFramework:"eliminarNovedad"}],components:{eliminarNovedad:r}}},mounted:function(){this.gridApi=this.gridOptions.api},computed:{paginationPageSize:function(){return this.gridApi?this.gridApi.paginationGetPageSize():10},totalPages:function(){return this.gridApi?this.gridApi.paginationGetTotalPages():0},currentPage:{get:function(){return this.gridApi?this.gridApi.paginationGetCurrentPage()+1:1},set:function(e){this.gridApi.paginationGoToPage(e-1)}}},created:function(){this.listarNovedades()},methods:{listarNovedades:function(){var e=this;this.cargandoGeneral=!0,axios.post("/procesos/novedad.listarNovedades",this.filtro).then((function(t){e.datos=t.data.datos,e.listaGestores=t.data.gestores,e.filtro.fechaInicio=o.DateTime.fromSQL(t.data.fechaInicio),e.filtro.fechaFinal=o.DateTime.fromSQL(t.data.fechaFinal),e.cargandoGeneral=!1}))},filtroNovedades:function(){var e=this;this.cargandoGeneral=!0,axios.post("/procesos/novedad.listarNovedades",this.filtro).then((function(t){e.datos=t.data.datos,e.cargandoGeneral=!1}))},updateSearchQuery:function(e){this.gridApi.setQuickFilter(e)},infoEditNovedad:function(e){this.infoNovedad=Object.assign({},e),this.abrirPoput=!0},infoActualizada:function(){this.abrirPoput=!1,this.listarNovedades()}},watch:{abrirPoput:function(e){e||(this.infoNovedad=[])}}},m=Object(n.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vx-card p-6"},[a("vs-popup",{attrs:{classContent:"popup-example",title:"Editar novedad",active:e.abrirPoput},on:{"update:active":function(t){e.abrirPoput=t}}},[a("editar-novedad",{attrs:{novedad:e.infoNovedad}})],1),e._v(" "),a("vs-row",[a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"4","vs-lg":"4","vs-xl":"4"}},[a("strong",[e._v("Gestor")]),e._v(" "),a("vs-select",{staticClass:"selectExample w-full",attrs:{autocomplete:"",multiple:""},on:{change:e.filtroNovedades},model:{value:e.filtro.gestor,callback:function(t){e.$set(e.filtro,"gestor",t)},expression:"filtro.gestor"}},[a("vs-select-item",{key:"",attrs:{value:"",text:"---seleccione---"}}),e._v(" "),e._l(e.listaGestores,(function(e,t){return a("vs-select-item",{key:t,staticClass:"disabledx",attrs:{value:e.id,text:e.text}})}))],2)],1),e._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"3","vs-lg":"3","vs-xl":"3"}},[a("strong",[e._v("Fecha desde")]),e._v(" "),a("datetime",{attrs:{type:"date","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd",auto:""},model:{value:e.filtro.fechaInicio,callback:function(t){e.$set(e.filtro,"fechaInicio",t)},expression:"filtro.fechaInicio"}})],1),e._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"3","vs-lg":"3","vs-xl":"3"}},[a("strong",[e._v("Fecha hasta")]),e._v(" "),a("datetime",{attrs:{type:"date","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd",auto:""},model:{value:e.filtro.fechaFinal,callback:function(t){e.$set(e.filtro,"fechaFinal",t)},expression:"filtro.fechaFinal"}})],1),e._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"2","vs-lg":"2","vs-xl":"2","vs-type":"flex","vs-justify":"center","vs-align":"center"}},[a("vs-button",{on:{click:function(t){return e.filtroNovedades()}}},[a("i",{staticClass:"bx bx-search"})])],1)],1),e._v(" "),a("div",{staticClass:"flex flex-wrap items-center"},[a("vs-input",{staticClass:"sm:mr-4 mr-0 sm:w-auto w-full sm:order-normal order-3 sm:mt-0 mt-4",attrs:{placeholder:"Buscar..."},on:{input:e.updateSearchQuery},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1),e._v(" "),a("ag-grid-vue",{ref:"agGridTable",staticClass:"ag-theme-material vs-table vs-table--tbody-table",staticStyle:{width:"100%",height:"400px"},attrs:{components:e.components,gridOptions:e.gridOptions,columnDefs:e.columnDefs,defaultColDef:e.defaultColDef,rowData:e.datos,rowSelection:"multiple",colResizeDefault:"shift",animateRows:!0,floatingFilter:!1,pagination:!0,paginationPageSize:e.paginationPageSize,suppressPaginationPanel:!0,enableRtl:e.$vs.rtl}}),e._v(" "),a("vs-pagination",{attrs:{total:e.totalPages,max:7},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)}),[],!1,null,"3c725d04",null);t.default=m.exports}}]);