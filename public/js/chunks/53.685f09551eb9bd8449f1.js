(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{cB4Q:function(a,s,t){"use strict";t.r(s);var e={name:"reserva_edit",props:{idReserva:{required:!0},opcion:{type:String,default:"lider"}},data:function(){return{unicareserva:[],numHoras:0,listaHoras:[],nroParticiones:null,listaParticiones:[]}},methods:{remarcaHoras:function(a,s,t){s.key;1==this.solonumeros(s)||s.preventDefault()},validarHoras:function(a){var s=0;return $.each(this.listaParticiones,(function(t,e){e.nroOrden!=a&&(s+=parseFloat(e.unidadesOrden))})),s},particionarReserva:function(){this.listaParticiones=[];for(var a=this.numHoras,s=this.nroParticiones,t=a/s,e=Math.round(t),i=a-e*s,r=0,n=(this.unicareserva[0],1);n<=this.nroParticiones;n++){var o=Object.assign({},this.unicareserva[0]);this.listaParticiones.push(o),this.listaParticiones[r].idReserva=0,this.listaParticiones[r].nroOrden=o.nroOrden+"-"+n,this.listaParticiones[r].unidadesOrden=n==s?i+e:e,this.listaParticiones[r].unidadesOrdenTotal=a,r++}},obtenerreservaId:function(){var a=this;axios.post("/reservas/listareservaId",{idReserva:this.idReserva}).then((function(s){a.unicareserva=s.data,a.numHoras=a.unicareserva[0].unidadesOrdenTotal;for(var t=2;t<=a.unicareserva[0].unidadesOrdenTotal;t++)a.listaHoras.push({id:t,text:t})}),(function(a){console.log(a)}))},guardarReserva:function(){var a=this;this.validarHoras(this.idReserva)==this.numHoras?(this.loading=!0,this.unicareserva[0].particiones=this.nroParticiones,axios.post("/reservas/GuardarParticion",{reserva:this.listaParticiones,idReserva:this.idReserva,totalHoras:this.numHoras,opcion:this.opcion}).then((function(s){"ok"==s.data?(a.$vs.notify({title:"Registro exitoso",text:a.nroParticiones.length>1?"Las reservas se encuentran en GESTION":"La reserva se encuentra en GESTION",color:"success"}),location.reload()):console.log("todo fail"),a.loading=!1}))):this.$vs.notify({title:"Total de horas",text:"El número de horas a segmentar debe ser igual al total de números de horas de la reserva.",color:"warning"})}},watch:{idReserva:function(a){this.obtenerreservaId()}}},i=t("KHd+"),r=Object(i.a)(e,(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{attrs:{id:"page-user-edit"}},[t("vx-card",[t("div",{staticClass:"tabs-container px-6 pt-6",attrs:{slot:"no-body"},slot:"no-body"},[t("vs-tabs",{staticClass:"tab-action-btn-fill-conatiner"},[t("vs-tab",{attrs:{label:"Segmentar","icon-pack":"feather",icon:"icon-grid"}},[t("div",{staticClass:"tab-text"},[a._l(a.unicareserva,(function(s){return t("div",{key:s.id,staticClass:"vx-row"},[t("div",{staticClass:"vx-col sm:w-3/3 w-full mb-4"},[t("vx-card",[t("div",{staticClass:"vx-row"},[t("div",{staticClass:"vx-col sm:w-12/12 md:w-4/12 lg:w-4/12 w-full mb-2"},[a._v("Orden Nro:\n                                            "+a._s(s.nroOrden||"")+"\n                                        ")]),a._v(" "),t("div",{staticClass:"vx-col sm:w-12/12 md:w-4/12 lg:w-4/12 w-full mb-2"},[a._v("\n                                            "+a._s(a.numHoras)+" - horas\n                                        ")]),a._v(" "),t("div",{staticClass:"vx-col sm:w-12/12 md:w-4/12 lg:w-4/12 w-full mb-2"},[t("validation-provider",{attrs:{name:"nroParticiones",rules:"required"},scopedSlots:a._u([{key:"default",fn:function(s){var e=s.errors;return[t("Select2",{staticClass:"w-100",attrs:{options:a.listaHoras},on:{change:a.particionarReserva},model:{value:a.nroParticiones,callback:function(s){a.nroParticiones=s},expression:"nroParticiones"}}),a._v(" "),t("span",{staticClass:"text-danger"},[a._v(a._s(e[0]))])]}}],null,!0)})],1)])])],1)])})),a._v(" "),t("div",{staticClass:"vx-row"},[t("div",{staticClass:"vx-col sm:w-12/12 md:w-12/12 lg:w-12/12 w-full mb-2"},a._l(a.listaParticiones,(function(s,e){return t("vs-list",{key:s.id},[t("vs-list-item",{attrs:{title:s.nroOrden,subtitle:""}},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.listaParticiones[e].unidadesOrden,expression:"listaParticiones[index].unidadesOrden"}],key:"input_"+e,staticClass:"vs-inputx vs-input--input normal",domProps:{value:a.listaParticiones[e].unidadesOrden},on:{keydown:function(t){return a.remarcaHoras(s.nroOrden,t,s.unidadesOrdenTotal)},input:function(s){s.target.composing||a.$set(a.listaParticiones[e],"unidadesOrden",s.target.value)}}})])],1)})),1)]),a._v(" "),t("div",{staticClass:"vx-row"},[t("div",{staticClass:"vx-col sm:w-3/3 w-full mb-2 mb-base"},[a.listaParticiones.length>0?t("boton",{attrs:{texto_cargando:"Guardando...",texto:"Guardar reservas",cargando:a.loading},nativeOn:{click:function(s){return a.guardarReserva(s)}}}):a._e()],1)])],2)])],1)],1)])],1)}),[],!1,null,null,null);s.default=r.exports}}]);