(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{G91M:function(t,e,a){"use strict";var n=a("rrFr"),s=a.n(n),r={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,required:!1},exportFields:{type:Object,required:!1},defaultValue:{type:String,required:!1,default:""},title:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function}},computed:{idName:()=>"export_"+(new Date).getTime(),downloadFields(){return void 0!==this.fields?this.fields:void 0!==this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"==typeof this.beforeGenerate&&await this.beforeGenerate();let t=this.data;if("function"!=typeof this.fetch&&t||(t=await this.fetch()),!t||!t.length)return;let e=this.getProcessedJson(t,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(e),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(e),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(e),this.name,"application/vnd.ms-excel")},export:async function(t,e,a){let n=this.base64ToBlob(t,a);"function"==typeof this.beforeFinish&&await this.beforeFinish(),s()(n,e,a)},jsonToXLS(t){let e="<thead>";const a=Object.keys(t[0]).length;let n=this;null!=this.title&&(e+=this.parseExtraData(this.title,'<tr><th colspan="'+a+'">${data}</th></tr>')),e+="<tr>";for(let a in t[0])e+="<th>"+a+"</th>";return e+="</tr>",e+="</thead>",e+="<tbody>",t.map((function(t,a){e+="<tr>";for(let a in t)e+="<td>"+n.valueReformattedForMultilines(t[a])+"</td>";e+="</tr>"})),e+="</tbody>",null!=this.footer&&(e+="<tfoot>",e+=this.parseExtraData(this.footer,'<tr><td colspan="'+a+'">${data}</td></tr>'),e+="</tfoot>"),'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>'.replace("${table}",e).replace("${worksheet}",this.worksheet)},jsonToCSV(t){var e=[];null!=this.title&&e.push(this.parseExtraData(this.title,"${data}\r\n"));for(let a in t[0])e.push(a),e.push(",");return e.pop(),e.push("\r\n"),t.map((function(t){for(let a in t){let n='="'+t[a]+'"';n.match(/[,"\n]/)&&(n='"'+n.replace(/\"/g,'""')+'"'),e.push(n),e.push(",")}e.pop(),e.push("\r\n")})),null!=this.footer&&e.push(this.parseExtraData(this.footer,"${data}\r\n")),e.join("")},getProcessedJson(t,e){let a=this.getKeys(t,e),n=[],s=this;return t.map((function(t,e){let r={};for(let e in a){let n=a[e];r[e]=s.getValue(n,t)}n.push(r)})),n},getKeys(t,e){if(e)return e;let a={};for(let e in t[0])a[e]=e;return a},parseExtraData(t,e){let a="";if(Array.isArray(t))for(var n=0;n<t.length;n++)a+=e.replace("${data}",t[n]);else a+=e.replace("${data}",t);return a},getValue(t,e){const a="object"!=typeof t?t:t.field;let n="string"!=typeof a?[]:a.split("."),s=this.defaultValue;return s=a?n.length>1?this.getValueFromNestedItem(e,n):this.parseValue(e[a]):e,t.hasOwnProperty("callback")&&(s=this.getValueFromCallback(s,t.callback)),s},valueReformattedForMultilines:t=>"string"==typeof t?t.replace(/\n/gi,"<br/>"):t,getValueFromNestedItem(t,e){let a=t;for(let t of e)a&&(a=a[t]);return this.parseValue(a)},getValueFromCallback(t,e){if("function"!=typeof e)return this.defaultValue;const a=e(t);return this.parseValue(a)},parseValue(t){return t||0===t||"boolean"==typeof t?t:this.defaultValue},base64ToBlob(t,e){let a=window.btoa(window.unescape(encodeURIComponent(t))),n=atob(a),s=n.length,r=new Uint8ClampedArray(s);for(;s--;)r[s]=n.charCodeAt(s);return new Blob([r],{type:e})}}},o=a("KHd+"),i=Object(o.a)(r,(function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:this.idName},on:{click:this.generate}},[this._t("default",[this._v("\n\t\tDownload "+this._s(this.name)+"\n\t")])],2)}),[],!1,null,null,null);e.a=i.exports},lavE:function(t,e,a){"use strict";a.r(e);var n=a("o0o1"),s=a.n(n);function r(t,e,a,n,s,r,o){try{var i=t[r](o),l=i.value}catch(t){return void a(t)}i.done?e(l):Promise.resolve(l).then(n,s)}var o,i,l={name:"planes",data:function(){return{datos:[],poputActivo:!1,datosDetallePlan:[],anio:null,mes:null,nombreArchivo:""}},components:{descargarExcel:a("G91M").a},created:function(){this.consultarPlanes()},methods:{consultarPlanes:function(){var t=this;this.cargandoGeneral=!0,axios.post("/planificacion/consultarListaPlanes").then((function(e){t.datos=e.data,t.cargandoGeneral=!1}))},mesesString:function(t){return this.meses[t-1]},consultarDetallePlan:function(t){var e=this;this.cargandoGeneral=!0,axios.post("/planificacion/consultarDetallePlan",{id:t}).then((function(t){e.datosDetallePlan=t.data,e.poputActivo=!0,e.cargandoGeneral=!1}))},obtenerId:function(t,e){this.anio=t,this.mes=e,this.nombreArchivo="PlanReserva_"+t+"_"+this.meses[e-1]+".xls",$("#descargarDatos").click()},planReservas:(o=s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,axios.post("/planificacion/planReservas",{anio:this.anio,mes:this.mes});case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(a,n){var s=o.apply(t,e);function i(t){r(s,a,n,i,l,"next",t)}function l(t){r(s,a,n,i,l,"throw",t)}i(void 0)}))},function(){return i.apply(this,arguments)}),startDownload:function(){this.cargandoGeneral=!0},finishDownload:function(){this.cargandoGeneral=!1}}},c=a("KHd+"),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vx-card",{attrs:{title:"Lista de planes"}},[a("descargarExcel",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"vs-component vs-button vs-button-border vs-button-primary",attrs:{id:"descargarDatos",fetch:t.planReservas,name:t.nombreArchivo,"before-generate":t.startDownload,"before-finish":t.finishDownload}},[t._v("\n        Descargar datos\n    ")]),t._v(" "),a("vs-table",{attrs:{data:t.datos,pagination:"","max-items":20,search:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.data;return t._l(n,(function(e,s){return a("vs-tr",{key:s},[a("vs-td",{attrs:{data:n[s].id}},[t._v("\n                    "+t._s(n[s].id)+"\n                ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].planMes}},[t._v("\n                    "+t._s(t.mesesString(n[s].planMes))+"\n                ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].planAnio}},[t._v("\n                    "+t._s(n[s].planAnio)+"\n                ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].monto}},[t._v("\n                    "+t._s(t.convertirdecimal(n[s].monto))+"\n                ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].metaMes}},[t._v("\n                    "+t._s(t.convertirdecimal(n[s].metaMes))+"\n                ")]),t._v(" "),a("vs-td",[a("vs-row",{attrs:{"vs-type":"flex","vs-justify":"flex-center"}},[a("vs-col",{attrs:{"vs-sm":"6","vs-md":"6","vs-lg":"6","vs-type":"flex","vs-justify":"center","vs-align":"center","vs-w":"6"}},[a("vx-tooltip",{attrs:{text:"Ver detalle plan "+t.mesesString(n[s].planMes)}},[a("router-link",{attrs:{to:{name:"planeacion.planDetalle",query:{anio:n[s].planAnio,mes:n[s].planMes}}}},[a("i",{staticClass:"material-icons font-weight-bold"},[t._v("visibility")])])],1)],1),t._v(" "),a("vs-col",{attrs:{"vs-sm":"6","vs-md":"6","vs-lg":"6","vs-type":"flex","vs-justify":"center","vs-align":"center","vs-w":"6"}},[a("i",{staticClass:"material-icons",on:{click:function(e){return e.preventDefault(),t.obtenerId(n[s].planAnio,n[s].planMes)}}},[t._v("cloud_download")])])],1)],1)],1)}))}}])},[a("template",{slot:"thead"},[a("vs-th",[t._v("ID")]),t._v(" "),a("vs-th",[t._v("Mes")]),t._v(" "),a("vs-th",[t._v("Año")]),t._v(" "),a("vs-th",[t._v("Monto")]),t._v(" "),a("vs-th",[t._v("Meta")]),t._v(" "),a("vs-th",{staticClass:"text-center center d-flex flex justify-center"},[t._v("Acciones")])],1)],2),t._v(" "),a("vs-popup",{staticClass:"holamundo",attrs:{fullscreen:"",active:t.poputActivo},on:{"update:active":function(e){t.poputActivo=e}}},[a("vs-table",{attrs:{data:t.datosDetallePlan,pagination:"","max-items":20,search:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.data;return t._l(n,(function(e,s){return a("vs-tr",{key:s},[a("vs-td",{attrs:{data:n[s].id}},[t._v("\n                        "+t._s(n[s].id)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].nroOrden}},[t._v("\n                        "+t._s(n[s].nroOrden)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].nroOrdenPadre}},[t._v("\n                        "+t._s(n[s].nroOrdenPadre)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].obsOrden}},[t._v("\n                        "+t._s(n[s].obsOrden)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].estadoReserva}},[t._v("\n                        "+t._s(n[s].estadoReserva)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].valorunitario}},[t._v("\n                        "+t._s(t.convertirdecimal(n[s].valorunitario))+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].horas}},[t._v("\n                        "+t._s(n[s].horas)+"\n                    ")]),t._v(" "),a("vs-td",{attrs:{data:n[s].valor}},[t._v("\n                        "+t._s(t.convertirdecimal(n[s].valor))+"\n                    ")])],1)}))}}])},[a("template",{slot:"thead"},[a("vs-th",[t._v("ID")]),t._v(" "),a("vs-th",[t._v("Nro Orden")]),t._v(" "),a("vs-th",[t._v("Nro Orden Padre")]),t._v(" "),a("vs-th",[t._v("Observación")]),t._v(" "),a("vs-th",[t._v("Estado reserva")]),t._v(" "),a("vs-th",[t._v("Valor unitario")]),t._v(" "),a("vs-th",[t._v("Horas")]),t._v(" "),a("vs-th",[t._v("Total")])],1)],2)],1)],1)}),[],!1,null,"bb7099de",null);e.default=d.exports},rrFr:function(t,e,a){var n,s,r;s=[],void 0===(r="function"==typeof(n=function(){return function t(e,a,n){var s,r,o=window,i="application/octet-stream",l=n||i,c=e,d=!a&&!n&&c,u=document.createElement("a"),v=function(t){return String(t)},h=o.Blob||o.MozBlob||o.WebKitBlob||v,p=a||"download";if(h=h.call?h.bind(o):Blob,"true"===String(this)&&(l=(c=[c,l])[0],c=c[1]),d&&d.length<2048&&(p=d.split("/").pop().split("?")[0],u.href=d,-1!==u.href.indexOf(d))){var f=new XMLHttpRequest;return f.open("GET",d,!0),f.responseType="blob",f.onload=function(e){t(e.target.response,p,i)},setTimeout((function(){f.send()}),0),f}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&h!==v))return navigator.msSaveBlob?navigator.msSaveBlob(y(c),p):x(c);l=(c=y(c)).type||i}else if(/([\x80-\xff])/.test(c)){for(var m=0,_=new Uint8Array(c.length),b=_.length;m<b;++m)_[m]=c.charCodeAt(m);c=new h([_],{type:l})}function y(t){for(var e=t.split(/[:;,]/),a=e[1],n=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),s=n.length,r=0,o=new Uint8Array(s);r<s;++r)o[r]=n.charCodeAt(r);return new h([o],{type:a})}function x(t,e){if("download"in u)return u.href=t,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===e&&setTimeout((function(){o.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,i)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var a=document.createElement("iframe");document.body.appendChild(a),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,i)),a.src=t,setTimeout((function(){document.body.removeChild(a)}),333)}if(s=c instanceof h?c:new h([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(s,p);if(o.URL)x(o.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===v)try{return x("data:"+l+";base64,"+o.btoa(s))}catch(t){return x("data:"+l+","+encodeURIComponent(s))}(r=new FileReader).onload=function(t){x(this.result)},r.readAsDataURL(s)}return!0}})?n.apply(e,s):n)||(t.exports=r)}}]);