(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{SKne:function(t,e,a){"use strict";var o=a("G91M"),s=a("ExVU"),r=a("H8ri"),i=r.d.reactiveProp,n={extends:r.c,mixins:[i],props:{chartData:{type:Object,default:null},options:{type:Object,default:null}},mounted:function(){this.renderChart(this.chartData,this.options)}},l=a("KHd+"),c=Object(l.a)(n,void 0,void 0,!1,null,null,null).exports,d=(a("qb46"),r.d.reactiveProp),p={extends:r.a,mixins:[d],props:{chartData:{type:Object,default:null},options:{type:Object,default:null}},mounted:function(){this.renderChart(this.data,this.options)}},v=Object(l.a)(p,void 0,void 0,!1,null,null,null).exports,u=r.d.reactiveProp,h={extends:r.b,mixins:[u],props:{chartData:{type:Object,default:null},options:{type:Object,default:null}},mounted:function(){this.renderChart(this.data,this.options)}},m=Object(l.a)(h,void 0,void 0,!1,null,null,null).exports,f=a("ESDC"),b=(a("QUPH"),a("wd/R")),g=a.n(b),x={name:"dashboarPrincipal",components:{ChartjsComponentHorizontalBarChart:m,ChartjsComponentBarChart:v,ChartjsComponentLineChart:c,descargarExcel:o.a,VuePivottable:f.a,VuePivottableUi:f.b},props:{categoria:{type:Array,required:!0},subcategoria:{type:Array,required:!0}},data:function(){return{filtro:{tipo:1,fechaInicio:null,fechaFinal:null},datosTablaReporte:[],listaTipoReporte:[],reporteSeleccionado:{},allReportes:[],seleccionFiltro:"",seleccionFiltro2:"",tabPrincipal:0,tabSecundario:"",columnas:[],datosChart:{},options:{hover:{mode:"nearest",intersect:!0},plugins:{datalabels:{formatter:function(t,e){return parseFloat(t).toLocaleString("de-DE")}}},scales:{yAxes:[{ticks:{beginAtZero:!0},gridLines:{display:!0}}],xAxes:[{ticks:{beginAtZero:!0},gridLines:{display:!1}}]},legend:{display:!0},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,e){return"$"+parseFloat(t.yLabel).toLocaleString("de-DE")}}},responsive:!0,maintainAspectRatio:!1,height:200},datosTabla:[],nombreReporte:""}},computed:{nombreArchivo:function(){return this.nombreReporte+"_"+this.filtro.fechaInicio.substring(0,10)+"_"+this.filtro.fechaFinal.substring(0,10)+".xls"}},created:function(){this.filtro.fechaInicio=s.DateTime.fromJSDate(g()().add(0,"months").startOf("month").toDate()).toISODate(),this.filtro.fechaFinal=s.DateTime.fromJSDate(g()().add(0,"months").endOf("month").toDate()).toISODate(),this.consultarTablaReportes()},methods:{changeReporte:function(){var t=this,e=this.datosTablaReporte.find((function(e){return e.id==t.filtro.tipo}));this.nombreReporte=e.nombreRep,this.consultarReporte()},consultarReporte:function(){var t=this;""!=this.filtro.tipo&&null!=this.filtro.tipo?this.isEmpty(this.filtro.fechaInicio)||this.isEmpty(this.filtro.fechaFinal)?this.mostrarNotificacion("Filtro vacio","La fecha de inicio o final no pueden estar vacios","warning"):(this.cargandoGeneral=!0,this.reporteSeleccionado=this.datosTablaReporte.find((function(e){return e.id==t.filtro.tipo})),axios.post("/reportes/consultarReporte",{consulta:this.reporteSeleccionado,fechaInicio:this.filtro.fechaInicio,fechaFin:this.filtro.fechaFinal}).then((function(e){var a=e.data;t.datosTabla=a.datos,t.datosChart=a.datosChart.length>0?a.datosChart[0]:[],t.armarTabla(),t.cargandoGeneral=!1}))):this.mostrarNotificacion("Reporte vacio","Debe seleccionar un reporte","warning")},armarTabla:function(){for(var t in this.columnas=[],this.datosTabla[0])this.columnas.push(t)},consultarTablaReportes:function(){var t=this;this.cargandoGeneral=!0,axios.post("/reportes/consultarTablaReportes",{categoria:this.categoria,subcategoria:this.subcategoria}).then((function(e){t.cargandoGeneral=!1;var a=e.data;t.datosTablaReporte=a.datos,t.allReportes=a.datos,t.reporteSeleccionado=t.datosTablaReporte[0],t.filtro.tipo=t.reporteSeleccionado.id,t.nombreReporte=t.reporteSeleccionado.nombreRep,t.datosTablaReporte.length>0&&t.consultarReporte()}))},esNumero:function(t){return"number"==typeof t?this.convertirdecimal(t):t},validarArray:function(t){var e=t.split(","),a=[];return $.each(e,(function(t,e){a.push(e)})),a}}},y=Object(l.a)(x,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vs-row",[a("vs-card",{attrs:{header:"Categorias"}},[a("vs-row",[a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"4","vs-lg":"4","vs-xl":"4"}},[a("strong",[t._v("Reporte")]),t._v(" "),a("vs-select",{staticClass:"selectExample w-full",attrs:{autocomplete:""},on:{change:t.changeReporte},model:{value:t.filtro.tipo,callback:function(e){t.$set(t.filtro,"tipo",e)},expression:"filtro.tipo"}},[a("vs-select-item",{key:"",attrs:{value:"",text:"---seleccione---"}}),t._v(" "),t._l(t.datosTablaReporte,(function(t,e){return a("vs-select-item",{key:e,staticClass:"disabledx",attrs:{value:t.id,text:t.categoria+" - "+t.nombreRep}})}))],2)],1),t._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"3","vs-lg":"3","vs-xl":"3"}},[a("strong",[t._v("Fecha desde")]),t._v(" "),a("datetime",{attrs:{type:"date","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd",auto:""},model:{value:t.filtro.fechaInicio,callback:function(e){t.$set(t.filtro,"fechaInicio",e)},expression:"filtro.fechaInicio"}})],1),t._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"3","vs-lg":"3","vs-xl":"3"}},[a("strong",[t._v("Fecha hasta")]),t._v(" "),a("datetime",{attrs:{type:"date","input-class":"vs-inputx vs-input--input normal","value-zone":"America/Bogota",zone:"America/Bogota",format:"yyyy-MM-dd",auto:""},model:{value:t.filtro.fechaFinal,callback:function(e){t.$set(t.filtro,"fechaFinal",e)},expression:"filtro.fechaFinal"}})],1),t._v(" "),a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"2","vs-lg":"2","vs-xl":"2","vs-type":"flex","vs-justify":"center","vs-align":"center"}},[a("vs-button",{on:{click:function(e){return t.consultarReporte()}}},[a("i",{staticClass:"bx bx-search"})])],1)],1),t._v(" "),a("vs-row",{directives:[{name:"show",rawName:"v-show",value:t.datosTabla.length>0,expression:"datosTabla.length>0"}],attrs:{"vs-type":"flex","vs-justify":"flex-end"}},[a("div",{staticClass:"vx-col sm:12/12 md:w-12/12 lg:w-12/12"},[a("descargarExcel",{staticClass:"vs-component vs-button vs-button-border vs-button-primary",attrs:{data:t.datosTabla,name:t.nombreArchivo}},[t._v("\n                    Descargar datos\n                ")])],1)]),t._v(" "),a("vs-row",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.datosChart).length>0,expression:"Object.keys(datosChart).length>0"}]},[a("vs-col",{staticClass:"mb-2 p-2",attrs:{"vs-sm":"12","vs-md":"12","vs-lg":"12","vs-xl":"12"}},[a("div",{attrs:{id:"chart"}},[Object.keys(t.reporteSeleccionado).length>0?a("div",[1==t.reporteSeleccionado.grafico?a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:"linea"==t.reporteSeleccionado.tipo,expression:"reporteSeleccionado.tipo=='linea'"}]},[a("chartjs-component-line-chart",{attrs:{"chart-data":t.datosChart,options:t.options}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"barra"==t.reporteSeleccionado.tipo,expression:"reporteSeleccionado.tipo=='barra'"}]},[a("chartjs-component-bar-chart",{attrs:{"chart-data":t.datosChart,options:t.options}})],1)]):t._e()]):t._e()])]),t._v(" "),a("vs-col",{staticClass:"mb-2",attrs:{"vs-sm":"12","vs-md":"12","vs-lg":"12","vs-xl":"12","vs-type":"flex","vs-justify":"center","vs-align":"center"}},[a("div",{staticClass:"btn-group"},[a("vs-button",{attrs:{size:"small"}},[t._v("D")]),t._v(" "),a("vs-button",{attrs:{size:"small"}},[t._v("S")]),t._v(" "),a("vs-button",{attrs:{size:"small"}},[t._v("M")])],1)])],1),t._v(" "),Object.keys(t.reporteSeleccionado).length>0?a("vs-row",[a("vs-col",{staticClass:"mb-2",attrs:{"vs-sm":"12","vs-md":"12","vs-lg":"12","vs-xl":"12","vs-type":"flex","vs-justify":"center","vs-align":"center"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.reporteSeleccionado.grafico,expression:"reporteSeleccionado.grafico==0"}]},[a("vue-pivottable-ui",{staticClass:"w-full w-100",attrs:{data:t.datosTabla,aggregatorName:"Sum",rendererName:t.reporteSeleccionado.tipo,rows:t.validarArray(t.reporteSeleccionado.ejeX),cols:t.validarArray(t.reporteSeleccionado.ejeY),vals:t.validarArray(t.reporteSeleccionado.series)}})],1)])],1):t._e()],1)],1)}),[],!1,null,"1359515e",null);e.a=y.exports},zYFx:function(t,e,a){"use strict";a.r(e);var o={name:"reportes",components:{DashboarPrincipal:a("SKne").a}},s=a("KHd+"),r=Object(s.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return this.isRole("liderprogramacion")?e("div",[e("dashboar-principal",{attrs:{categoria:[2],subcategoria:[20,21]}})],1):this.isRole("admin|coordservicio")?e("div",[e("dashboar-principal",{attrs:{categoria:[0,1,2],subcategoria:[]}})],1):this._e()}),[],!1,null,"731dfb4b",null);e.default=r.exports}}]);